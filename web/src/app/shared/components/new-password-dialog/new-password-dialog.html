<form [formGroup]="form" class="grid gap-4">
  <div class="grid gap-1.5">
    <label for="currentPassword" class="text-sm font-medium">Current Password</label>
    <div class="relative">
      <input
        z-input
        id="currentPassword"
        [type]="showPassword() ? 'text' : 'password'"
        formControlName="currentPassword"
        placeholder="Enter current password"
        [zStatus]="form.controls.currentPassword.touched && form.controls.currentPassword.invalid ? 'error' : undefined"
      />
      
      <span class="material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer select-none" (click)="togglePassword()">
        <i-lucide [img]="showPassword() ? EyeIcon : EyeOffIcon" class="size-4.5" />
      </span>
    </div>

    @if (form.controls.currentPassword.touched && form.controls.currentPassword.errors?.['required']) {
      <p class="text-destructive text-xs">Current password is required.</p>
    }
  </div>

  <div class="grid gap-1.5">
    <label for="newPassword" class="text-sm font-medium">New Password</label>
    <div class="relative">
      <input
        z-input
        id="newPassword"
        [type]="showPassword() ? 'text' : 'password'"
        formControlName="newPassword"
        placeholder="Enter new password"
        [zStatus]="form.controls.newPassword.touched && form.controls.newPassword.invalid ? 'error' : undefined"
      />

      <span class="material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer select-none" (click)="togglePassword()">
        <i-lucide [img]="showPassword() ? EyeIcon : EyeOffIcon" class="size-4.5" />
      </span>
    </div>

    @if (form.controls.newPassword.touched && form.controls.newPassword.errors) {
      @if (form.controls.newPassword.errors['required']) {
        <p class="text-destructive text-xs">Password is required.</p>
      } @else if (form.controls.newPassword.errors['pattern']) {
        <p class="text-destructive text-xs">
          Password must include uppercase, lowercase, number, and symbol.
        </p>
      }
    } @else {
      <p class="text-muted-foreground text-xs">
        Minimum 6 characters, including uppercase, lowercase, numbers, and symbols.
      </p>
    }
  </div>

  <div class="grid gap-1.5">
    <label for="confirmPassword" class="text-sm font-medium">Confirm Password</label>
    <div class="relative">
      <input
        z-input
        id="confirmPassword"
        [type]="showPassword() ? 'text' : 'password'"
        formControlName="confirmPassword"
        placeholder="Confirm new password"
        [zStatus]="form.controls.confirmPassword.touched && (form.controls.confirmPassword.invalid || !passwordsMatch()) ? 'error' : undefined"
      />

      <span class="material-symbols-outlined absolute right-4 top-1/2 -translate-y-1/2 text-gray-400 cursor-pointer select-none" (click)="togglePassword()">
        <i-lucide [img]="showPassword() ? EyeIcon : EyeOffIcon" class="size-4.5" />
      </span>
    </div>


    @if (form.controls.confirmPassword.touched) {
      @if (form.controls.confirmPassword.errors?.['required']) {
        <p class="text-destructive text-xs">Please confirm your password.</p>
      } @else if (!passwordsMatch()) {
        <p class="text-destructive text-xs">Passwords do not match.</p>
      }
    }
  </div>
</form>